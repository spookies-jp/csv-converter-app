(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{526:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>v});var n=l(7876),a=l(4232),r=l(7328),s=l.n(r),c=l(1401),i=l.n(c),o=l(5023),d=l(9275),m=l.n(d),u=l(8220),_=l(2919),p=l.n(_);let h=e=>{let{replacementRules:t,error:l,onAddRule:r,onUpdateRule:s,onDeleteRule:c,onToggleRule:i,onToggleAllRules:o,onReorderRules:d,onClearAllRules:m,onClearError:u}=e,[_,h]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null),v=e=>{j(e),h(!1),u()},N=()=>{j(null),h(!1),u()},R=e=>{e>0&&d(e,e-1)},S=e=>{e<t.length-1&&d(e,e+1)},b=t.filter(e=>e.isEnabled).length,B=t.length>0;return(0,n.jsxs)("div",{className:p().replacementSection,children:[(0,n.jsxs)("div",{className:p().header,children:[(0,n.jsx)("h3",{className:p().title,children:"文字列置換設定"}),B&&(0,n.jsxs)("div",{className:p().summary,children:[b," / ",t.length," ルールが有効"]})]}),l&&(0,n.jsxs)("div",{className:p().error,children:[l,(0,n.jsx)("button",{onClick:u,className:p().errorClose,children:"\xd7"})]}),B&&(0,n.jsxs)("div",{className:p().rulesList,children:[(0,n.jsxs)("div",{className:p().rulesHeader,children:[(0,n.jsx)("span",{children:"置換ルール（上から順に適用）"}),(0,n.jsxs)("div",{className:p().bulkActions,children:[(0,n.jsx)("button",{onClick:()=>o(!0),className:p().bulkButton,disabled:b===t.length,children:"全て有効"}),(0,n.jsx)("button",{onClick:()=>o(!1),className:p().bulkButton,disabled:0===b,children:"全て無効"}),(0,n.jsx)("button",{onClick:m,className:p().bulkButtonDanger,children:"全て削除"})]})]}),t.map((e,l)=>(0,n.jsx)(x,{rule:e,index:l,isFirst:0===l,isLast:l===t.length-1,isEditing:(null==f?void 0:f.id)===e.id,onEdit:v,onUpdate:s,onDelete:c,onToggle:i,onMoveUp:R,onMoveDown:S,onCancelEdit:N},e.id))]}),!B&&(0,n.jsxs)("div",{className:p().emptyState,children:[(0,n.jsx)("div",{className:p().emptyIcon,children:"\uD83D\uDCDD"}),(0,n.jsx)("h4",{children:"文字列置換ルールが設定されていません"}),(0,n.jsx)("p",{children:"CSVファイルの文字列を置換するルールを追加してください"})]}),_&&(0,n.jsx)(g,{onAdd:r,onCancel:N}),!_&&!f&&(0,n.jsx)("button",{onClick:()=>{h(!0),j(null),u()},className:p().addButton,children:"+ 新しい置換ルールを追加"})]})},x=e=>{let{rule:t,index:l,isFirst:a,isLast:r,isEditing:s,onEdit:c,onUpdate:i,onDelete:o,onToggle:d,onMoveUp:m,onMoveDown:u,onCancelEdit:_}=e;return s?(0,n.jsx)(f,{rule:t,onUpdate:i,onCancel:_}):(0,n.jsx)("div",{className:"".concat(p().ruleItem," ").concat(t.isEnabled?"":p().disabled),children:(0,n.jsxs)("div",{className:p().ruleContent,children:[(0,n.jsx)("div",{className:p().ruleOrder,children:l+1}),(0,n.jsxs)("div",{className:p().ruleText,children:[(0,n.jsxs)("div",{className:p().searchText,children:[(0,n.jsx)("strong",{children:"検索:"}),' "',t.searchText,'"']}),(0,n.jsxs)("div",{className:p().replaceText,children:[(0,n.jsx)("strong",{children:"置換:"}),' "',t.replaceText||"(削除)",'"']})]}),(0,n.jsxs)("div",{className:p().ruleActions,children:[(0,n.jsx)("button",{onClick:()=>d(t.id),className:"".concat(p().toggleButton," ").concat(t.isEnabled?p().enabled:p().disabled),children:t.isEnabled?"有効":"無効"}),(0,n.jsx)("button",{onClick:()=>c(t),className:p().editButton,children:"編集"}),(0,n.jsxs)("div",{className:p().moveButtons,children:[(0,n.jsx)("button",{onClick:()=>m(l),disabled:a,className:p().moveButton,children:"↑"}),(0,n.jsx)("button",{onClick:()=>u(l),disabled:r,className:p().moveButton,children:"↓"})]}),(0,n.jsx)("button",{onClick:()=>o(t.id),className:p().deleteButton,children:"削除"})]})]})})},g=e=>{let{onAdd:t,onCancel:l}=e,[r,s]=(0,a.useState)(""),[c,i]=(0,a.useState)("");return(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(r,c)&&(s(""),i(""),l())},className:p().ruleForm,children:[(0,n.jsx)("h4",{children:"新しい置換ルールを追加"}),(0,n.jsxs)("div",{className:p().formGroup,children:[(0,n.jsx)("label",{htmlFor:"searchText",children:"検索する文字列 *"}),(0,n.jsx)("input",{id:"searchText",type:"text",value:r,onChange:e=>s(e.target.value),placeholder:"置換したい文字列を入力",className:p().input,required:!0})]}),(0,n.jsxs)("div",{className:p().formGroup,children:[(0,n.jsx)("label",{htmlFor:"replaceText",children:"置換後の文字列"}),(0,n.jsx)("input",{id:"replaceText",type:"text",value:c,onChange:e=>i(e.target.value),placeholder:"置換後の文字列を入力（空の場合は削除）",className:p().input})]}),(0,n.jsxs)("div",{className:p().formActions,children:[(0,n.jsx)("button",{type:"submit",className:p().submitButton,children:"追加"}),(0,n.jsx)("button",{type:"button",onClick:l,className:p().cancelButton,children:"キャンセル"})]})]})},f=e=>{let{rule:t,onUpdate:l,onCancel:r}=e,[s,c]=(0,a.useState)(t.searchText),[i,o]=(0,a.useState)(t.replaceText);return(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l(t.id,s,i)&&r()},className:p().ruleForm,children:[(0,n.jsx)("h4",{children:"置換ルールを編集"}),(0,n.jsxs)("div",{className:p().formGroup,children:[(0,n.jsx)("label",{htmlFor:"editSearchText",children:"検索する文字列 *"}),(0,n.jsx)("input",{id:"editSearchText",type:"text",value:s,onChange:e=>c(e.target.value),placeholder:"置換したい文字列を入力",className:p().input,required:!0})]}),(0,n.jsxs)("div",{className:p().formGroup,children:[(0,n.jsx)("label",{htmlFor:"editReplaceText",children:"置換後の文字列"}),(0,n.jsx)("input",{id:"editReplaceText",type:"text",value:i,onChange:e=>o(e.target.value),placeholder:"置換後の文字列を入力（空の場合は削除）",className:p().input})]}),(0,n.jsxs)("div",{className:p().formActions,children:[(0,n.jsx)("button",{type:"submit",className:p().submitButton,children:"更新"}),(0,n.jsx)("button",{type:"button",onClick:r,className:p().cancelButton,children:"キャンセル"})]})]})},j=()=>{let[e,t]=(0,a.useState)([]),[l,n]=(0,a.useState)("");(0,a.useEffect)(()=>{try{let e=localStorage.getItem("csvConverter_replacementRules");if(e){let l=JSON.parse(e);t(l)}}catch(e){console.error("Failed to load replacement rules:",e),n("置換ルールの読み込みに失敗しました")}},[]);let r=e=>{try{localStorage.setItem("csvConverter_replacementRules",JSON.stringify(e)),t(e),n("")}catch(e){console.error("Failed to save replacement rules:",e),n("置換ルールの保存に失敗しました")}},s=function(t,l){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t&&""!==t.trim()?e.some(e=>e.id!==n&&e.searchText===t)?"同じ検索文字列が既に存在します":null:"検索する文字列を入力してください"},c=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{replacementRules:e,error:l,addRule:(t,l)=>{let a=s(t,l);if(a)return n(a),!1;let c={id:"rule_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),searchText:t.trim(),replaceText:l||"",isEnabled:!0,order:e.length};return r([...e,c]),!0},updateRule:(t,l,a)=>{let c=s(l,a,t);return c?(n(c),!1):(r(e.map(e=>e.id===t?{...e,searchText:l.trim(),replaceText:a||""}:e)),!0)},deleteRule:t=>{r(e.filter(e=>e.id!==t).map((e,t)=>({...e,order:t})))},toggleRule:t=>{r(e.map(e=>e.id===t?{...e,isEnabled:!e.isEnabled}:e))},toggleAllRules:t=>{r(e.map(e=>({...e,isEnabled:t})))},reorderRules:(t,l)=>{let n=[...e],[a]=n.splice(t,1);n.splice(l,0,a),r(n.map((e,t)=>({...e,order:t})))},clearAllRules:()=>{r([])},applyReplacements:t=>{if(!t||0===e.length)return{processedContent:t,stats:{totalReplacements:0,appliedRules:[]}};let l=t,n={totalReplacements:0,appliedRules:[]};for(let t of e.filter(e=>e.isEnabled).sort((e,t)=>e.order-t.order))try{let e=(l.match(RegExp(c(t.searchText),"g"))||[]).length;e>0&&(l=l.replace(RegExp(c(t.searchText),"g"),t.replaceText),n.totalReplacements+=e,n.appliedRules.push({searchText:t.searchText,replaceText:t.replaceText,count:e}))}catch(e){console.error("Error applying replacement rule:",e)}return{processedContent:l,stats:n}},clearError:()=>{n("")}}};function v(){let[e,t]=(0,a.useState)([]),[l,r]=(0,a.useState)(!1),[c,d]=(0,a.useState)(""),[_,p]=(0,a.useState)(null),x=(0,a.useRef)(null),{replacementRules:g,error:f,addRule:v,updateRule:N,deleteRule:R,toggleRule:S,toggleAllRules:b,reorderRules:B,clearAllRules:C,applyReplacements:T,clearError:H}=j(),y=async e=>{let l=Array.from(e.target.files);if(0===l.length)return;let n=l.filter(e=>e.name.endsWith(".csv"));if(0===n.length)return void d("CSVファイルのみアップロードできます");r(!0),d("");try{let e=[];for(let t of n){var a;let l=await t.arrayBuffer(),n=u.Buffer.from(l),r=o.detect(n),s=(null==r||null==(a=r.encoding)?void 0:a.toLowerCase())||"",c=/^[\x00-\x7F]*$/.test(n.toString("binary"));if((!s||r.confidence<.2||c)&&(s="shift_jis"),!["utf-8","ascii","shift_jis","windows-1252"].includes(s))throw Error("".concat(t.name," は未対応の文字コードです（推定: ").concat(s,"）"));let i="utf-8"===s||"ascii"===s,d=m().decode(n,s),_="\uFEFF"+d;e.push({originalName:t.name,content:_,originalEncoding:s,isAlreadyUtf8:i})}t(t=>[...t,...e]),x.current&&(x.current.value="")}catch(e){console.error("Error converting files:",e),d("ファイルの変換中にエラーが発生しました: "+e.message)}finally{r(!1)}},k=e=>{t(t=>{let l=[...t];return l.splice(e,1),l})},E=(e,t)=>{if(!e)return;let{processedContent:l,stats:n}=T(e);p(n),n.totalReplacements>0&&(console.log("文字列置換: ".concat(n.totalReplacements,"件の置換を実行しました")),n.appliedRules.forEach(e=>{console.log('  "'.concat(e.searchText,'" → "').concat(e.replaceText,'": ').concat(e.count,"件"))}));let a=new Blob([l],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(a),s=document.createElement("a");s.href=r,s.setAttribute("download","utf8-".concat(t||"converted.csv")),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r),setTimeout(()=>{p(null)},5e3)};return(0,n.jsxs)("div",{className:i().container,children:[(0,n.jsxs)(s(),{children:[(0,n.jsx)("title",{children:"CSV文字コード変換アプリ"}),(0,n.jsx)("meta",{name:"description",content:"CSVファイルをUTF-8に変換するアプリ"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"})]}),(0,n.jsxs)("main",{className:i().main,children:[(0,n.jsx)("h1",{className:i().title,children:"CSV文字コード変換アプリ"}),(0,n.jsx)("p",{className:i().description,children:"CSVファイルをUTF-8に変換します"}),(0,n.jsxs)("div",{className:i().card,children:[(0,n.jsxs)("div",{className:i().uploadContainer,children:[(0,n.jsxs)("label",{htmlFor:"csvFile",className:i().uploadButton,children:["CSVファイルを追加",(0,n.jsx)("input",{type:"file",id:"csvFile",accept:".csv",onChange:y,className:i().fileInput,multiple:!0,ref:x})]}),e.length>0&&(0,n.jsxs)("span",{className:i().fileName,children:[e.length," ファイル"]})]}),l&&(0,n.jsx)("div",{className:i().loading,children:"変換処理中..."}),c&&(0,n.jsx)("div",{className:i().error,children:c}),e.length>0&&(0,n.jsxs)("div",{className:i().results,children:[(0,n.jsx)("h3",{children:"変換済みファイル"}),_&&_.totalReplacements>0&&(0,n.jsxs)("div",{className:i().replacementStats,children:[(0,n.jsx)("h4",{children:"文字列置換結果"}),(0,n.jsxs)("p",{children:["合計 ",_.totalReplacements," 件の置換を実行しました"]}),(0,n.jsx)("div",{className:i().replacementDetails,children:_.appliedRules.map((e,t)=>(0,n.jsxs)("div",{className:i().replacementDetail,children:['"',e.searchText,'" → "',e.replaceText,'": ',e.count,"件"]},t))})]}),(0,n.jsx)("div",{className:i().fileList,children:e.map((e,t)=>(0,n.jsxs)("div",{className:i().fileItem,children:[(0,n.jsxs)("div",{className:i().fileHeader,children:[(0,n.jsxs)("div",{className:i().fileInfo,children:[(0,n.jsx)("span",{className:i().fileName,children:e.originalName}),(0,n.jsx)("span",{className:i().encoding,children:e.isAlreadyUtf8?"既にUTF-8形式":"元の文字コード: ".concat(e.originalEncoding)})]}),(0,n.jsx)("button",{onClick:()=>k(t),className:i().removeButton,children:"\xd7"})]}),(0,n.jsx)("button",{onClick:()=>E(e.content,e.originalName),className:i().downloadButton,children:e.isAlreadyUtf8?"ダウンロード":"UTF-8でダウンロード"})]},t))}),(0,n.jsx)("div",{className:i().actionBar,children:(0,n.jsx)("button",{onClick:()=>t([]),className:i().clearAllButton,children:"全てのファイルを削除"})})]})]}),(0,n.jsx)(h,{replacementRules:g,error:f,onAddRule:v,onUpdateRule:N,onDeleteRule:R,onToggleRule:S,onToggleAllRules:b,onReorderRules:B,onClearAllRules:C,onClearError:H})]}),(0,n.jsx)("footer",{className:i().footer,children:(0,n.jsxs)("p",{children:["CSV文字コード変換アプリ \xa9 ",new Date().getFullYear()]})})]})}},1401:e=>{e.exports={container:"Home_container__d256j",main:"Home_main__VkIEL",footer:"Home_footer__yFiaX",title:"Home_title__hYX6j",description:"Home_description__uXNdx",card:"Home_card__E5spL",uploadContainer:"Home_uploadContainer__fvHj1",uploadButton:"Home_uploadButton__wPWeA",fileInput:"Home_fileInput__m8A_b",fileName:"Home_fileName__mufoT",loading:"Home_loading__Z_JGo",loadingSpinner:"Home_loadingSpinner__XoUQF",spin:"Home_spin__VEV0f",error:"Home_error__514Ji",results:"Home_results__lDLyn",fadeIn:"Home_fadeIn__6AUDn",fileList:"Home_fileList__DdcvS",fileItem:"Home_fileItem__xJOhV",fileHeader:"Home_fileHeader__5_1b0",fileInfo:"Home_fileInfo__0i46t",encoding:"Home_encoding__vb_s_",alreadyUtf8:"Home_alreadyUtf8__w8lS2",removeButton:"Home_removeButton__rEUbQ",downloadButton:"Home_downloadButton__GHDC0",downloadButtonUtf8:"Home_downloadButtonUtf8__c5Rg2",actionBar:"Home_actionBar__tWRGD",clearAllButton:"Home_clearAllButton__sZ_f4",replacementStats:"Home_replacementStats__HW3Pk",replacementDetails:"Home_replacementDetails__DgQLf",replacementDetail:"Home_replacementDetail__aUcxG"}},2919:e=>{e.exports={replacementSection:"StringReplacement_replacementSection__kFaAm",header:"StringReplacement_header__8fLtq",title:"StringReplacement_title__64131",summary:"StringReplacement_summary__7gOIN",error:"StringReplacement_error__PCt6Y",fadeIn:"StringReplacement_fadeIn__JSWNd",errorClose:"StringReplacement_errorClose___OjSI",emptyState:"StringReplacement_emptyState__QxiPY",emptyIcon:"StringReplacement_emptyIcon__jqBra",rulesList:"StringReplacement_rulesList__WwBl8",rulesHeader:"StringReplacement_rulesHeader__GcNqE",bulkActions:"StringReplacement_bulkActions__58s__",bulkButton:"StringReplacement_bulkButton__x_gh3",bulkButtonDanger:"StringReplacement_bulkButtonDanger__lIoDd",ruleItem:"StringReplacement_ruleItem__RvFG6",disabled:"StringReplacement_disabled___g_NZ",ruleContent:"StringReplacement_ruleContent__K4qAx",ruleOrder:"StringReplacement_ruleOrder__a0LfH",ruleText:"StringReplacement_ruleText__M383o",searchText:"StringReplacement_searchText__YcKT8",replaceText:"StringReplacement_replaceText__CwvMB",ruleActions:"StringReplacement_ruleActions__Tpe5W",toggleButton:"StringReplacement_toggleButton__wDmcC",enabled:"StringReplacement_enabled__88uWW",editButton:"StringReplacement_editButton__UGvQs",moveButtons:"StringReplacement_moveButtons__BwWb1",moveButton:"StringReplacement_moveButton__nDHh3",deleteButton:"StringReplacement_deleteButton__9Blcz",ruleForm:"StringReplacement_ruleForm__miXTQ",formGroup:"StringReplacement_formGroup__pDkNv",input:"StringReplacement_input__RAKrx",formActions:"StringReplacement_formActions__CWutR",submitButton:"StringReplacement_submitButton__ux_Li",cancelButton:"StringReplacement_cancelButton__Kymuj",addButton:"StringReplacement_addButton__A7Hli"}},2936:(e,t,l)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(526)}])},6403:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[252,636,593,792],()=>t(2936)),_N_E=e.O()}]);